import{c as k,o as L,r as d,j as e,m,i as $}from"./index-BMjTxWI5.js";import{a as A}from"./adminStore-69BTUR3l.js";import{f as z}from"./formatters-DNE1yS1Z.js";import{f}from"./dateUtils-S97u1aLj.js";import{M as C}from"./mail-B3DolKbK.js";import"./AccountService-vNVs7x2E.js";/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],y=k("ban",T),V="_userManagement_orz8v_1",M="_header_orz8v_11",D="_headerContent_orz8v_27",B="_title_orz8v_35",F="_subtitle_orz8v_51",H="_stats_orz8v_67",E="_statCard_orz8v_81",q="_statValue_orz8v_109",G="_statLabel_orz8v_125",J="_controls_orz8v_141",K="_search_orz8v_157",O="_searchIcon_orz8v_171",P="_searchInput_orz8v_189",Q="_filters_orz8v_237",W="_filterSelect_orz8v_251",X="_tableContainer_orz8v_319",Y="_table_orz8v_319",Z="_tableRow_orz8v_385",ee="_userInfo_orz8v_403",se="_avatar_orz8v_415",te="_username_orz8v_443",ae="_userId_orz8v_457",oe="_contacts_orz8v_471",ne="_contact_orz8v_471",le="_roleSelect_orz8v_501",ce="_error_orz8v_543",ie="_warning_orz8v_555",re="_success_orz8v_567",de="_secondary_orz8v_579",me="_status_orz8v_591",_e="_balance_orz8v_641",he="_orders_orz8v_641",be="_date_orz8v_641",ve="_actions_orz8v_679",xe="_actionBtn_orz8v_691",je="_ban_orz8v_733",ue="_unban_orz8v_741",pe="_loading_orz8v_761",Ne="_loadingSpinner_orz8v_783",ze="_spin_orz8v_867",fe="_emptyState_orz8v_801",Ce="_emptyContent_orz8v_817",ye="_emptyIcon_orz8v_825",Ie="_emptyTitle_orz8v_837",Ue="_emptyText_orz8v_853",ge="_spinning_orz8v_867",Se="_mobileUsers_orz8v_891",we="_mobileUserCard_orz8v_903",Re="_mobileUserHeader_orz8v_923",ke="_mobileUserInfo_orz8v_937",Le="_mobileAvatar_orz8v_951",$e="_mobileUserDetails_orz8v_979",Ae="_mobileUsername_orz8v_987",Te="_mobileUserId_orz8v_1001",Ve="_mobileUserContent_orz8v_1013",Me="_mobileInfoRow_orz8v_1025",De="_mobileInfoLabel_orz8v_1049",Be="_mobileInfoValue_orz8v_1061",Fe="_mobileContacts_orz8v_1075",He="_mobileContact_orz8v_1075",Ee="_mobileRoleSelect_orz8v_1105",qe="_mobileStatus_orz8v_1133",Ge="_mobileActions_orz8v_1153",s={userManagement:V,header:M,headerContent:D,title:B,subtitle:F,stats:H,statCard:E,statValue:q,statLabel:G,controls:J,search:K,searchIcon:O,searchInput:P,filters:Q,filterSelect:W,tableContainer:X,table:Y,tableRow:Z,userInfo:ee,avatar:se,username:te,userId:ae,contacts:oe,contact:ne,roleSelect:le,error:ce,warning:ie,success:re,secondary:de,status:me,balance:_e,orders:he,date:be,actions:ve,actionBtn:xe,ban:je,unban:ue,loading:pe,loadingSpinner:Ne,spin:ze,emptyState:fe,emptyContent:Ce,emptyIcon:ye,emptyTitle:Ie,emptyText:Ue,spinning:ge,mobileUsers:Se,mobileUserCard:we,mobileUserHeader:Re,mobileUserInfo:ke,mobileAvatar:Le,mobileUserDetails:$e,mobileUsername:Ae,mobileUserId:Te,mobileUserContent:Ve,mobileInfoRow:Me,mobileInfoLabel:De,mobileInfoValue:Be,mobileContacts:Fe,mobileContact:He,mobileRoleSelect:Ee,mobileStatus:qe,mobileActions:Ge},Ye=L(()=>{const{users:i,loading:b,fetchUsers:v,updateUserRole:I,updateUserStatus:U}=A,[n,g]=d.useState(""),[l,S]=d.useState("all"),[c,w]=d.useState("all");d.useEffect(()=>{v()},[v]);const _=i.filter(t=>{const a=t.email?.toLowerCase().includes(n.toLowerCase())||t.username?.toLowerCase().includes(n.toLowerCase())||t.id?.toString().includes(n),o=l==="all"||t.role===l,r=c==="all"||t.status===c;return a&&o&&r}),x=async(t,a)=>{if(window.confirm(`Вы уверены, что хотите изменить роль пользователя на "${R(a)}"?`))try{await I(t,a)}catch{alert("Пока недоступно")}},j=async(t,a)=>{const o=a==="unblocked"?"blocked":"unblocked",r=o==="blocked"?"заблокировать":"разблокировать";if(window.confirm(`Вы уверены, что хотите ${r} пользователя?`))try{await U(t,o),window.location.reload()}catch{alert(`Ошибка при ${r} пользователя`)}},u=t=>({admin:"error",user:"secondary"})[t]||"secondary",R=t=>({admin:"Администратор",user:"Пользователь"})[t]||t,p=t=>t==="unblocked"?"success":"error",N=t=>t==="unblocked"?"Разблокирован":"Заблокирован",h={total:i.length,blocked:i.filter(t=>t.status==="blocked").length,admins:i.filter(t=>t.role==="admin").length};return e.jsxs(m.div,{initial:{opacity:0},animate:{opacity:1},className:s.userManagement,children:[e.jsx("div",{className:s.header,children:e.jsxs("div",{className:s.headerContent,children:[e.jsx("h1",{className:s.title,children:"Управление пользователями"}),e.jsx("p",{className:s.subtitle,children:"Просмотр и управление пользователями системы"})]})}),e.jsxs("div",{className:s.stats,children:[e.jsxs("div",{className:s.statCard,children:[e.jsx("div",{className:s.statValue,children:h.total}),e.jsx("div",{className:s.statLabel,children:"Всего пользователей"})]}),e.jsxs("div",{className:s.statCard,children:[e.jsx("div",{className:s.statValue,children:h.blocked}),e.jsx("div",{className:s.statLabel,children:"Заблокированных"})]}),e.jsxs("div",{className:s.statCard,children:[e.jsx("div",{className:s.statValue,children:h.admins}),e.jsx("div",{className:s.statLabel,children:"Администраторов"})]})]}),e.jsxs("div",{className:s.controls,children:[e.jsxs("div",{className:s.search,children:[e.jsx($,{size:20,className:s.searchIcon}),e.jsx("input",{type:"text",placeholder:"Поиск по email, имени или ID...",className:s.searchInput,value:n,onChange:t=>g(t.target.value)})]}),e.jsxs("div",{className:s.filters,children:[e.jsxs("select",{className:s.filterSelect,value:l,onChange:t=>S(t.target.value),children:[e.jsx("option",{value:"all",children:"Все роли"}),e.jsx("option",{value:"user",children:"Пользователь"}),e.jsx("option",{value:"admin",children:"Администратор"})]}),e.jsxs("select",{className:s.filterSelect,value:c,onChange:t=>w(t.target.value),children:[e.jsx("option",{value:"all",children:"Все статусы"}),e.jsx("option",{value:"unblocked",children:"Разблокированные"}),e.jsx("option",{value:"blocked",children:"Заблокированные"})]})]})]}),e.jsx("div",{className:s.tableContainer,children:b?e.jsx("div",{className:s.loading,children:"Загрузка пользователей..."}):e.jsxs("table",{className:s.table,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Пользователь"}),e.jsx("th",{children:"Контакты"}),e.jsx("th",{children:"Роль"}),e.jsx("th",{children:"Статус"}),e.jsx("th",{children:"Баланс"}),e.jsx("th",{children:"Заказы"}),e.jsx("th",{children:"Дата регистрации"}),e.jsx("th",{children:"Действия"})]})}),e.jsx("tbody",{children:_.map((t,a)=>e.jsxs(m.tr,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:a*.1},className:s.tableRow,children:[e.jsx("td",{children:e.jsxs("div",{className:s.userInfo,children:[e.jsx("div",{className:s.avatar,children:t.username?.charAt(0).toUpperCase()||t.email?.charAt(0).toUpperCase()||"U"}),e.jsxs("div",{children:[e.jsx("div",{className:s.username,children:t.userName||"Без имени"}),e.jsxs("div",{className:s.userId,children:["ID: ",t.id]})]})]})}),e.jsx("td",{children:e.jsx("div",{className:s.contacts,children:e.jsxs("div",{className:s.contact,children:[e.jsx(C,{size:14}),e.jsx("span",{children:t.email})]})})}),e.jsx("td",{children:e.jsxs("select",{className:`${s.roleSelect} ${s[u(t.role)]}`,value:t.role,onChange:o=>x(t.id,o.target.value),children:[e.jsx("option",{value:"user",children:"Пользователь"}),e.jsx("option",{value:"admin",children:"Администратор"})]})}),e.jsx("td",{children:e.jsx("span",{className:`${s.status} ${s[p(t.status)]}`,children:N(t.status)})}),e.jsx("td",{className:s.balance,children:z(t.balance||0)}),e.jsx("td",{className:s.orders,children:t.ordersCount||0}),e.jsx("td",{className:s.date,children:f(t.createdAt)}),e.jsx("td",{children:e.jsx("div",{className:s.actions,children:e.jsx("button",{className:`${s.actionBtn} ${t.status==="blocked"?s.unban:s.ban}`,title:t.status==="unblocked"?"Заблокировать":"Разблокировать",onClick:()=>j(t.id,t.status),children:e.jsx(y,{size:16})})})})]},t.id))})]})}),e.jsx("div",{className:s.mobileUsers,children:_.map((t,a)=>e.jsxs(m.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:a*.1},className:s.mobileUserCard,children:[e.jsxs("div",{className:s.mobileUserHeader,children:[e.jsxs("div",{className:s.mobileUserInfo,children:[e.jsx("div",{className:s.mobileAvatar,children:t.username?.charAt(0).toUpperCase()||t.email?.charAt(0).toUpperCase()||"U"}),e.jsxs("div",{className:s.mobileUserDetails,children:[e.jsx("h3",{className:s.mobileUsername,children:t.userName||"Без имени"}),e.jsxs("p",{className:s.mobileUserId,children:["ID: ",t.id]})]})]}),e.jsx("span",{className:`${s.mobileStatus} ${s[p(t.status)]}`,children:N(t.status)})]}),e.jsx("div",{className:s.mobileContacts,children:e.jsxs("div",{className:s.mobileContact,children:[e.jsx(C,{size:14}),e.jsx("span",{children:t.email})]})}),e.jsxs("div",{className:s.mobileUserContent,children:[e.jsxs("div",{className:s.mobileInfoRow,children:[e.jsx("span",{className:s.mobileInfoLabel,children:"Роль:"}),e.jsxs("select",{className:`${s.mobileRoleSelect} ${s[u(t.role)]}`,value:t.role,onChange:o=>x(t.id,o.target.value),children:[e.jsx("option",{value:"user",children:"Пользователь"}),e.jsx("option",{value:"admin",children:"Администратор"})]})]}),e.jsxs("div",{className:s.mobileInfoRow,children:[e.jsx("span",{className:s.mobileInfoLabel,children:"Баланс:"}),e.jsx("span",{className:s.mobileInfoValue,children:z(t.balance||0)})]}),e.jsxs("div",{className:s.mobileInfoRow,children:[e.jsx("span",{className:s.mobileInfoLabel,children:"Заказы:"}),e.jsx("span",{className:s.mobileInfoValue,children:t.ordersCount||0})]}),e.jsxs("div",{className:s.mobileInfoRow,children:[e.jsx("span",{className:s.mobileInfoLabel,children:"Регистрация:"}),e.jsx("span",{className:s.mobileInfoValue,children:f(t.createdAt)})]})]}),e.jsx("div",{className:s.mobileActions,children:e.jsxs("button",{className:`${s.actionBtn} ${t.status==="blocked"?s.unban:s.ban}`,title:t.status==="unblocked"?"Заблокировать":"Разблокировать",onClick:()=>j(t.id,t.status),children:[e.jsx(y,{size:16}),t.status==="unblocked"?"Заблокировать":"Разблокировать"]})})]},t.id))}),_.length===0&&!b&&e.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:s.emptyState,children:e.jsxs("div",{className:s.emptyContent,children:[e.jsx("h3",{className:s.emptyTitle,children:n||l!=="all"||c!=="all"?"Пользователи не найдены":"Пользователей пока нет"}),e.jsx("p",{className:s.emptyText,children:n||l!=="all"||c!=="all"?"Попробуйте изменить параметры поиска":"Зарегистрированные пользователи появятся здесь"})]})})]})});export{Ye as default};
