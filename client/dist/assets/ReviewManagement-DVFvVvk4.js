import{o as q,r as c,j as e,m as i,i as y,X as N}from"./index-BMjTxWI5.js";import{a as f}from"./adminStore-69BTUR3l.js";import{B as d}from"./Button-D0cEhXue.js";import{f as C}from"./dateUtils-S97u1aLj.js";import{C as S}from"./check-DLZoD-Wd.js";import"./AccountService-vNVs7x2E.js";const T="_reviewManagement_1qnme_1",I="_header_1qnme_11",M="_title_1qnme_19",L="_subtitle_1qnme_35",F="_controls_1qnme_51",R="_search_1qnme_67",b="_searchIcon_1qnme_81",z="_searchInput_1qnme_99",H="_filters_1qnme_147",k="_filterSelect_1qnme_161",A="_reviewsList_1qnme_229",D="_reviewCard_1qnme_241",E="_reviewHeader_1qnme_269",$="_userInfo_1qnme_283",B="_avatar_1qnme_295",U="_userDetails_1qnme_323",V="_username_1qnme_335",X="_account_1qnme_349",G="_rating_1qnme_361",J="_reviewContent_1qnme_375",K="_reviewTitle_1qnme_383",O="_reviewText_1qnme_399",P="_reviewFooter_1qnme_413",Q="_reviewMeta_1qnme_429",W="_status_1qnme_441",Y="_warning_1qnme_465",Z="_success_1qnme_477",ee="_error_1qnme_489",se="_date_1qnme_501",te="_actions_1qnme_513",ne="_loading_1qnme_629",ae="_loadingSpinner_1qnme_651",re="_spin_1qnme_1",ce="_emptyState_1qnme_681",ie="_emptyContent_1qnme_697",oe="_emptyIcon_1qnme_705",le="_emptyTitle_1qnme_717",me="_emptyText_1qnme_733",s={reviewManagement:T,header:I,title:M,subtitle:L,controls:F,search:R,searchIcon:b,searchInput:z,filters:H,filterSelect:k,reviewsList:A,reviewCard:D,reviewHeader:E,userInfo:$,avatar:B,userDetails:U,username:V,account:X,rating:G,reviewContent:J,reviewTitle:K,reviewText:O,reviewFooter:P,reviewMeta:Q,status:W,warning:Y,success:Z,error:ee,date:se,actions:te,loading:ne,loadingSpinner:ae,spin:re,emptyState:ce,emptyContent:ie,emptyIcon:oe,emptyTitle:le,emptyText:me},je=q(()=>{const{reviews:_,loading:o,fetchReviews:l,approveReview:p,rejectReview:h}=f,[a,v]=c.useState(""),[r,u]=c.useState("pending");c.useEffect(()=>{l()},[l]);const m=_.filter(t=>{const n=t.user?.email?.toLowerCase().includes(a.toLowerCase())||t.comment?.toLowerCase().includes(a.toLowerCase());return(r==="all"||t.status===r)&&n}),x=async t=>{try{await p(t),window.location.reload()}catch{alert("Ошибка при одобрении отзыва")}},j=async t=>{try{await h(t),window.location.reload()}catch{alert("Ошибка при отклонении отзыва")}},w=t=>({pending:"warning",approved:"success",rejected:"error"})[t]||"secondary",g=t=>({pending:"На модерации",approved:"Одобрен",rejected:"Отклонен"})[t]||t;return e.jsxs(i.div,{initial:{opacity:0},animate:{opacity:1},className:s.reviewManagement,children:[e.jsx("div",{className:s.header,children:e.jsxs("div",{children:[e.jsx("h1",{className:s.title,children:"Модерация отзывов"}),e.jsx("p",{className:s.subtitle,children:"Проверка и публикация отзывов пользователей"})]})}),e.jsxs("div",{className:s.controls,children:[e.jsxs("div",{className:s.search,children:[e.jsx(y,{size:20,className:s.searchIcon}),e.jsx("input",{type:"text",placeholder:"Поиск отзывов...",className:s.searchInput,value:a,onChange:t=>v(t.target.value)})]}),e.jsx("div",{className:s.filters,children:e.jsxs("select",{className:s.filterSelect,value:r,onChange:t=>u(t.target.value),children:[e.jsx("option",{value:"pending",children:"На модерации"}),e.jsx("option",{value:"approved",children:"Одобренные"}),e.jsx("option",{value:"rejected",children:"Отклоненные"}),e.jsx("option",{value:"all",children:"Все"})]})})]}),e.jsx("div",{className:s.reviewsList,children:o?e.jsx("div",{className:s.loading,children:"Загрузка отзывов..."}):m.map((t,n)=>e.jsxs(i.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:n*.1},className:s.reviewCard,children:[e.jsxs("div",{className:s.reviewHeader,children:[e.jsxs("div",{className:s.userInfo,children:[e.jsx("div",{className:s.avatar,children:t.user?.email?.charAt(0).toUpperCase()||"U"}),e.jsxs("div",{children:[e.jsx("div",{className:s.username,children:t.user?.email||"Пользователь"}),e.jsx("div",{className:s.account,children:`Аккаунт #${t.accountId}`||"Аккаунт удален"})]})]}),e.jsxs("div",{className:s.rating,children:["★".repeat(t.ratingValue),"☆".repeat(5-t.ratingValue)]})]}),e.jsx("div",{className:s.reviewContent,children:e.jsx("p",{className:s.reviewText,children:t.comment||"Без комментария"})}),e.jsxs("div",{className:s.reviewFooter,children:[e.jsxs("div",{className:s.reviewMeta,children:[e.jsx("span",{className:`${s.status} ${s[w(t.status)]}`,children:g(t.status)}),e.jsx("span",{className:s.date,children:C(t.createdAt)})]}),e.jsx("div",{className:s.actions,children:t.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsxs(d,{variant:"success",size:"small",onClick:()=>x(t.id),children:[e.jsx(S,{size:16}),"Одобрить"]}),e.jsxs(d,{variant:"error",size:"small",onClick:()=>j(t.id),children:[e.jsx(N,{size:16}),"Отклонить"]})]})})]})]},t.id))}),m.length===0&&!o&&e.jsx(i.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:s.emptyState,children:e.jsxs("div",{className:s.emptyContent,children:[e.jsx("span",{className:s.emptyIcon,children:"⭐"}),e.jsx("h3",{className:s.emptyTitle,children:a||r!=="pending"?"Отзывы не найдены":"Нет отзывов для модерации"}),e.jsx("p",{className:s.emptyText,children:a||r!=="pending"?"Попробуйте изменить параметры поиска":"Все новые отзывы будут появляться здесь"})]})})]})});export{je as default};
