import{c as T,o as L,s as k,r,j as s,m as u}from"./index-C-KVzDfL.js";import{B as j}from"./Button-DNnCRmfV.js";import{I as p}from"./Input-BOMiBcEe.js";import{E as w}from"./eye-BDLj4RTa.js";import{a as c,C as l}from"./circle-x-CsmGMM7e.js";/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],y=T("eye-off",B),E="_securitySettings_18nnl_1",R="_title_18nnl_9",V="_error_18nnl_23",D="_success_18nnl_43",M="_form_18nnl_63",A="_section_18nnl_71",O="_sectionTitle_18nnl_85",Z="_passwordToggle_18nnl_99",F="_passwordRequirements_18nnl_127",X="_requirementsList_18nnl_157",$="_requirement_18nnl_157",G="_valid_18nnl_185",H="_invalid_18nnl_193",J="_submitBtn_18nnl_201",K="_securityInfo_18nnl_209",Q="_securityStatus_18nnl_223",U="_statusItem_18nnl_235",W="_statusLabel_18nnl_255",Y="_statusValue_18nnl_267",e={securitySettings:E,title:R,error:V,success:D,form:M,section:A,sectionTitle:O,passwordToggle:Z,passwordRequirements:F,requirementsList:X,requirement:$,valid:G,invalid:H,submitBtn:J,securityInfo:K,securityStatus:Q,statusItem:U,statusLabel:W,statusValue:Y},is=L(()=>{const{user:ss}=k,[t,v]=r.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[d,P]=r.useState(!1),[m,q]=r.useState(!1),[h,S]=r.useState(!1),[z,x]=r.useState(!1),[N,n]=r.useState(""),[f,g]=r.useState(""),_=a=>{v(o=>({...o,[a.target.name]:a.target.value})),n(""),g("")},b=a=>({length:a.length>=8,uppercase:/[A-Z]/.test(a),lowercase:/[a-z]/.test(a),number:/[0-9]/.test(a),special:/[!@#$%^&*(),.?":{}|<>]/.test(a)}),C=async a=>{if(a.preventDefault(),!t.currentPassword){n("Введите текущий пароль");return}if(!t.newPassword){n("Введите новый пароль");return}if(t.newPassword!==t.confirmPassword){n("Новые пароли не совпадают");return}const o=b(t.newPassword);if(!Object.values(o).every(Boolean)){n("Новый пароль не соответствует требованиям безопасности");return}x(!0),n("");try{setTimeout(()=>{g("Пароль успешно изменен"),v({currentPassword:"",newPassword:"",confirmPassword:""}),x(!1)},1e3)}catch(I){n(I.response?.data?.message||"Ошибка смены пароля"),x(!1)}},i=b(t.newPassword);return s.jsxs(u.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:e.securitySettings,children:[s.jsx("h2",{className:e.title,children:"Настройки безопасности"}),N&&s.jsx(u.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:e.error,children:N}),f&&s.jsx(u.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:e.success,children:f}),s.jsx("form",{onSubmit:C,className:e.form,children:s.jsxs("div",{className:e.section,children:[s.jsx("h3",{className:e.sectionTitle,children:"Смена пароля"}),s.jsx(p,{label:"Текущий пароль",type:d?"text":"password",name:"currentPassword",value:t.currentPassword,onChange:_,required:!0,icon:s.jsx("button",{type:"button",onClick:()=>P(!d),className:e.passwordToggle,children:d?s.jsx(y,{size:16}):s.jsx(w,{size:16})})}),s.jsx(p,{label:"Новый пароль",type:m?"text":"password",name:"newPassword",value:t.newPassword,onChange:_,required:!0,icon:s.jsx("button",{type:"button",onClick:()=>q(!m),className:e.passwordToggle,children:m?s.jsx(y,{size:16}):s.jsx(w,{size:16})})}),t.newPassword&&s.jsxs(u.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:e.passwordRequirements,children:[s.jsx("h4",{children:"Требования к паролю:"}),s.jsxs("div",{className:e.requirementsList,children:[s.jsxs("div",{className:e.requirement,children:[i.length?s.jsx(c,{size:14,className:e.valid}):s.jsx(l,{size:14,className:e.invalid}),s.jsx("span",{children:"Минимум 8 символов"})]}),s.jsxs("div",{className:e.requirement,children:[i.uppercase?s.jsx(c,{size:14,className:e.valid}):s.jsx(l,{size:14,className:e.invalid}),s.jsx("span",{children:"Заглавные буквы (A-Z)"})]}),s.jsxs("div",{className:e.requirement,children:[i.lowercase?s.jsx(c,{size:14,className:e.valid}):s.jsx(l,{size:14,className:e.invalid}),s.jsx("span",{children:"Строчные буквы (a-z)"})]}),s.jsxs("div",{className:e.requirement,children:[i.number?s.jsx(c,{size:14,className:e.valid}):s.jsx(l,{size:14,className:e.invalid}),s.jsx("span",{children:"Цифры (0-9)"})]}),s.jsxs("div",{className:e.requirement,children:[i.special?s.jsx(c,{size:14,className:e.valid}):s.jsx(l,{size:14,className:e.invalid}),s.jsx("span",{children:"Специальные символы"})]})]})]}),s.jsx(p,{label:"Подтвердите новый пароль",type:h?"text":"password",name:"confirmPassword",value:t.confirmPassword,onChange:_,required:!0,icon:s.jsx("button",{type:"button",onClick:()=>S(!h),className:e.passwordToggle,children:h?s.jsx(y,{size:16}):s.jsx(w,{size:16})})}),s.jsx(j,{type:"submit",variant:"primary",loading:z,className:e.submitBtn,children:"Сменить пароль"})]})}),s.jsxs("div",{className:e.securityInfo,children:[s.jsx("h3",{className:e.sectionTitle,children:"Безопасность аккаунта"}),s.jsxs("div",{className:e.securityStatus,children:[s.jsxs("div",{className:e.statusItem,children:[s.jsx("span",{className:e.statusLabel,children:"Двухфакторная аутентификация"}),s.jsx("span",{className:e.statusValue,children:"Не подключена"}),s.jsx(j,{variant:"secondary",size:"small",children:"Подключить"})]}),s.jsxs("div",{className:e.statusItem,children:[s.jsx("span",{className:e.statusLabel,children:"Активные сессии"}),s.jsx("span",{className:e.statusValue,children:"1 устройство"}),s.jsx(j,{variant:"secondary",size:"small",children:"Просмотреть"})]})]})]})]})});export{is as default};
