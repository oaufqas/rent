import{o as x,r as t,C as y,j as e,m as f,b as S,R as j,u as b,d as v}from"./index-BMjTxWI5.js";import{B as L}from"./Button-D0cEhXue.js";import{I as h}from"./Input-kAJO1UCZ.js";import{V as w}from"./VerificationCode-OGFjOFeF.js";const C="_form_ugfqn_1",E="_title_ugfqn_13",N="_error_ugfqn_27",q="_submitBtn_ugfqn_45",B="_registerLink_ugfqn_55",i={form:C,title:E,error:N,submitBtn:q,registerLink:B},I=x(({onSuccess:n})=>{const{store:c}=t.useContext(y),[s,u]=t.useState({email:"",password:""}),[d,l]=t.useState(!1),[p,r]=t.useState(""),m=a=>{u(o=>({...o,[a.target.name]:a.target.value})),r("")},g=async a=>{a.preventDefault(),l(!0),r("");try{const o=await c.login(s.email,s.password);n?.(o)}catch(o){console.error(o),r(o.response?.data?.message||"Ошибка входа")}finally{l(!1)}};return e.jsxs(f.form,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},onSubmit:g,className:i.form,children:[e.jsx("h2",{className:i.title,children:"Вход в аккаунт"}),p&&e.jsx(f.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:i.error,children:p}),e.jsx(h,{label:"Email",type:"email",name:"email",value:s.email,onChange:m,required:!0,placeholder:"your@email.com"}),e.jsx(h,{label:"Пароль",type:"password",name:"password",value:s.password,onChange:m,required:!0,placeholder:"Введите пароль"}),e.jsx(L,{type:"submit",variant:"primary",size:"large",loading:d,className:i.submitBtn,children:"Войти"}),e.jsxs("p",{className:i.registerLink,children:["Нет аккаунта? ",e.jsx(S,{to:j.REGISTER,children:"Зарегистрироваться"})]})]})}),k="_login_nha2e_1",R="_container_nha2e_17",_={login:k,container:R},O=x(()=>{const{store:n}=t.useContext(y),[c,s]=t.useState(1),[u,d]=t.useState(""),l=b(),r=v().state?.from?.pathname||j.HOME,m=a=>{d(a?.data?.userId),s(2)},g=()=>{n.setAuth(!0),n.setUser(n.user),l(r,{replace:!0}),window.location.reload()};return e.jsx("div",{className:_.login,children:e.jsxs(f.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:_.container,children:[c===1&&e.jsx(I,{onSuccess:m}),c===2&&e.jsx(w,{userId:u,onSuccess:g})]})})});export{O as default};
