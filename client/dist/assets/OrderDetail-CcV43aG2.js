import{o as v,e as j,u as N,r,j as e,L as f,m as w,g as S}from"./index-BMjTxWI5.js";import{o as z}from"./orderStore-DYeG6_Kd.js";import{S as g}from"./StatusBadge-DyHTHczb.js";import{O as R}from"./OrderTimeline-CDMCUv44.js";import{B as n}from"./Button-D0cEhXue.js";import"./dateUtils-S97u1aLj.js";import"./clock-DKQpXJuy.js";import"./check-DLZoD-Wd.js";const b="_orderDetail_dplz7_1",y="_container_dplz7_11",C="_loading_dplz7_23",T="_notFound_dplz7_23",D="_breadcrumbs_dplz7_63",P="_header_dplz7_101",E="_titleSection_dplz7_119",I="_title_dplz7_119",O="_date_dplz7_145",F="_timelineSection_dplz7_157",G="_content_dplz7_173",B="_sectionTitle_dplz7_185",L="_infoSection_dplz7_199",M="_infoGrid_dplz7_211",k="_infoCard_dplz7_223",A="_accountInfo_dplz7_251",U="_accountName_dplz7_277",q="_accountNumber_dplz7_291",H="_details_dplz7_301",J="_detail_dplz7_301",K="_totalPrice_dplz7_339",Q="_contact_dplz7_351",V="_payment_dplz7_385",W="_actionsSection_dplz7_393",X="_actions_dplz7_393",Y="_reviewStatus_dplz7_423",Z="_reviewExists_dplz7_431",$="_canReview_dplz7_433",ee="_cannotReview_dplz7_435",se="_reviewStatusText_dplz7_449",s={orderDetail:b,container:y,loading:C,notFound:T,breadcrumbs:D,header:P,titleSection:E,title:I,date:O,timelineSection:F,content:G,sectionTitle:B,infoSection:L,infoGrid:M,infoCard:k,accountInfo:A,accountName:U,accountNumber:q,details:H,detail:J,totalPrice:K,contact:Q,payment:V,actionsSection:W,actions:X,reviewStatus:Y,reviewExists:Z,canReview:$,cannotReview:ee,reviewStatusText:se},_e=v(()=>{const{id:a}=j(),{orders:d,loading:l,fetchMyOrders:c}=z,o=N(),[m,te]=r.useState(!1),t=d.find(i=>i.id===parseInt(a));if(r.useEffect(()=>{window.scrollTo(0,0),t||c()},[a,t,c]),l)return e.jsx("div",{className:s.loading,children:e.jsx(f,{fullScreen:!0})});if(!t)return e.jsxs("div",{className:s.notFound,children:[e.jsx("h2",{children:"Заказ не найден"}),e.jsx("p",{children:"Запрошенный заказ не существует"})]});const _=i=>new Date(i).toLocaleDateString("ru-RU",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}),h=i=>["pending","paid","verified","active","completed","cancelled"].indexOf(i),x=()=>{o(S.createReview(t.id))},p=t.status==="completed"&&t.canReview&&!t.hasReview,u=t.hasReview;return e.jsx(w.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:s.orderDetail,children:e.jsxs("div",{className:s.container,children:[e.jsxs("nav",{className:s.breadcrumbs,children:[e.jsx("a",{href:"/",children:"Главная"}),e.jsx("span",{children:"/"}),e.jsx("a",{href:"/orders",children:"Мои заказы"}),e.jsx("span",{children:"/"}),e.jsxs("span",{children:["Заказ #",t.id]})]}),e.jsxs("div",{className:s.header,children:[e.jsxs("div",{className:s.titleSection,children:[e.jsxs("h1",{className:s.title,children:["Заказ #",t.id]}),e.jsx(g,{status:t.status})]}),e.jsxs("p",{className:s.date,children:["Создан: ",_(t.createdAt)]})]}),e.jsx("div",{className:s.timelineSection,children:e.jsx(R,{status:t.status,currentStep:h(t.status)})}),e.jsxs("div",{className:s.content,children:[e.jsxs("div",{className:s.infoSection,children:[e.jsx("h2",{className:s.sectionTitle,children:"Информация о заказе"}),e.jsxs("div",{className:s.infoGrid,children:[e.jsxs("div",{className:s.infoCard,children:[e.jsx("h3",{children:"Аккаунт"}),e.jsxs("div",{className:s.accountInfo,children:[e.jsx("img",{src:"/api/img/"+t.account?.img,alt:t.account?.title}),e.jsxs("div",{children:[e.jsx("div",{className:s.accountName,children:t.account?.title}),e.jsxs("div",{className:s.accountNumber,children:["#",t.account?.account_number]})]})]})]}),e.jsxs("div",{className:s.infoCard,children:[e.jsx("h3",{children:"Детали аренды"}),e.jsxs("div",{className:s.details,children:[e.jsxs("div",{className:s.detail,children:[e.jsx("span",{children:"Время аренды:"}),e.jsxs("span",{children:[t.rentPeriod," часов"]})]}),e.jsxs("div",{className:s.detail,children:[e.jsx("span",{children:"Цена за час:"}),e.jsxs("span",{children:[t.account?.price," ₽"]})]}),e.jsxs("div",{className:s.detail,children:[e.jsx("span",{children:"Общая стоимость:"}),e.jsxs("span",{className:s.totalPrice,children:[t.amount," ₽"]})]})]})]}),e.jsxs("div",{className:s.infoCard,children:[e.jsx("h3",{children:"Контактная информация"}),e.jsxs("div",{className:s.contact,children:[e.jsx("span",{children:"Контакт для связи:"}),e.jsx("strong",{children:t.userNameInPlatform})]})]}),e.jsxs("div",{className:s.infoCard,children:[e.jsx("h3",{children:"Способ оплаты"}),e.jsx("div",{className:s.payment,children:e.jsx("span",{children:t.paymentMethod==="balance"?"Баланс аккаунта":"Перевод"})})]})]})]}),e.jsxs("div",{className:s.actionsSection,children:[e.jsx("h2",{className:s.sectionTitle,children:"Действия"}),e.jsxs("div",{className:s.infoCard,children:[e.jsx("h3",{children:"Отзыв"}),e.jsx("div",{className:s.reviewStatus,children:u?e.jsx("div",{className:s.reviewExists,children:e.jsx("span",{className:s.reviewStatusText,children:"Отзыв уже оставлен"})}):p?e.jsxs("div",{className:s.canReview,children:[e.jsx("span",{className:s.reviewStatusText,children:"Вы можете оставить отзыв"}),e.jsx(n,{variant:"primary",size:"large",onClick:x,loading:m,children:"Оставить отзыв"})]}):e.jsx("div",{className:s.cannotReview,children:e.jsx("span",{className:s.reviewStatusText,children:"Отзыв можно оставить после успешного завершения аренды"})})})]}),e.jsxs("div",{className:s.actions,children:[(t.status==="pending"||t.status==="paid")&&e.jsx(n,{variant:"primary",size:"large",children:"Отменить заказ"}),t.status==="active"&&e.jsx(n,{variant:"secondary",size:"large",children:"Запросить продление"})]})]})]})]})})});export{_e as default};
