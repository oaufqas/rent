import{c as D,o as w,s as R,r as m,j as e,m as d,S as $,L as O,u as A,R as S}from"./index-C-KVzDfL.js";import{B as y}from"./Button-DNnCRmfV.js";import{M as E}from"./Modal-2Jv52JHA.js";import{I}from"./Input-BOMiBcEe.js";import B from"./TransactionHistory-CIHpnPup.js";import{r as T}from"./reviewStore-DimOlXty.js";import{C as k,a as H}from"./circle-x-CsmGMM7e.js";import{C as M}from"./clock-ClSTzOvM.js";import{o as P}from"./orderStore-hDRCEfjD.js";import"./TransactionCard-DKiaLMeN.js";/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],V=D("message-circle",q),z="_editForm_vv52t_1",F="_error_vv52t_13",X="_success_vv52t_31",G="_avatarSection_vv52t_49",J="_avatarPreview_vv52t_69",K="_avatar_vv52t_49",Q="_avatarUpload_vv52t_121",W="_uploadLabel_vv52t_129",Y="_uploadInput_vv52t_159",Z="_uploadHint_vv52t_167",ee="_actions_vv52t_179",o={editForm:z,error:F,success:X,avatarSection:G,avatarPreview:J,avatar:K,avatarUpload:Q,uploadLabel:W,uploadInput:Y,uploadHint:Z,actions:ee},ae=w(({onClose:s})=>{const{user:c,updateUser:p}=R,[t,r]=m.useState({username:c?.username||"",email:c?.email||"",avatar:null}),[f,i]=m.useState(!1),[_,l]=m.useState(""),[x,N]=m.useState(""),b=v=>{r(h=>({...h,[v.target.name]:v.target.value})),l(""),N("")},g=v=>{const h=v.target.files[0];h&&r(C=>({...C,avatar:h}))},j=async v=>{if(v.preventDefault(),!t.username.trim()){l("Имя пользователя не может быть пустым");return}i(!0),l(""),N("")};return e.jsxs(d.form,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},onSubmit:j,className:o.editForm,children:[_&&e.jsx("div",{className:o.error,children:_}),x&&e.jsx("div",{className:o.success,children:x}),e.jsxs("div",{className:o.avatarSection,children:[e.jsx("div",{className:o.avatarPreview,children:e.jsx("div",{className:o.avatar,children:t.avatar?e.jsx("img",{src:URL.createObjectURL(t.avatar),alt:"Avatar preview"}):c?.username?.charAt(0).toUpperCase()||"U"})}),e.jsxs("div",{className:o.avatarUpload,children:[e.jsxs("label",{className:o.uploadLabel,children:[e.jsx("input",{type:"file",accept:"image/*",onChange:g,className:o.uploadInput}),"Выбрать изображение"]}),e.jsx("p",{className:o.uploadHint,children:"Рекомендуемый размер: 200x200px"})]})]}),e.jsx(I,{label:"Имя пользователя",name:"username",value:t.username,onChange:b,placeholder:"Введите новое имя пользователя"}),e.jsx(I,{label:"Email",type:"email",name:"email",value:t.email,onChange:b,placeholder:"your@email.com",disabled:!0}),e.jsxs("div",{className:o.actions,children:[e.jsx(y,{type:"button",variant:"secondary",onClick:s,children:"Отмена"}),e.jsx(y,{type:"submit",variant:"primary",loading:f,children:"Сохранить изменения"})]})]})}),te="_card_r4pco_1",se="_header_r4pco_25",ne="_accountInfo_r4pco_41",ce="_accountTitle_r4pco_49",ie="_rating_r4pco_63",oe="_filledStar_r4pco_73",re="_emptyStar_r4pco_81",le="_status_r4pco_89",me="_success_r4pco_113",de="_warning_r4pco_125",_e="_error_r4pco_137",ue="_comment_r4pco_149",pe="_commentIcon_r4pco_167",ve="_commentText_r4pco_179",he="_footer_r4pco_193",xe="_date_r4pco_207",fe="_orderRef_r4pco_217",n={card:te,header:se,accountInfo:ne,accountTitle:ce,rating:ie,filledStar:oe,emptyStar:re,status:le,success:me,warning:de,error:_e,comment:ue,commentIcon:pe,commentText:ve,footer:he,date:xe,orderRef:fe},je=({review:s})=>{const c=i=>{const _={pending:{icon:M,color:"warning",label:"На модерации"},approved:{icon:H,color:"success",label:"Опубликован"},rejected:{icon:k,color:"error",label:"Отклонен"}};return _[i]||_.pending},p=i=>Array.from({length:5},(_,l)=>e.jsx($,{size:16,className:l<i?n.filledStar:n.emptyStar,fill:l<i?"currentColor":"none"},l)),t=c(s.status),r=t.icon,f=i=>new Date(i).toLocaleDateString("ru-RU",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"});return e.jsxs(d.div,{whileHover:{x:4},className:n.card,children:[e.jsxs("div",{className:n.header,children:[e.jsxs("div",{className:n.accountInfo,children:[e.jsxs("h4",{className:n.accountTitle,children:["Аккаунт #",s.accountId]}),e.jsx("div",{className:n.rating,children:p(s.ratingValue)})]}),e.jsxs("div",{className:`${n.status} ${n[t.color]}`,children:[e.jsx(r,{size:14}),e.jsx("span",{children:t.label})]})]}),s.comment&&e.jsxs("div",{className:n.comment,children:[e.jsx(V,{size:16,className:n.commentIcon}),e.jsx("p",{className:n.commentText,children:s.comment})]}),e.jsxs("div",{className:n.footer,children:[e.jsx("span",{className:n.date,children:f(s.createdAt)}),s.orderId&&e.jsxs("span",{className:n.orderRef,children:["Заказ #",s.orderId]})]})]})},ye="_myReviews_ouoq0_1",Ne="_header_ouoq0_9",be="_loading_ouoq0_41",ge="_reviewsList_ouoq0_55",Ce="_emptyState_ouoq0_67",Se="_emptyContent_ouoq0_89",we="_emptyTitle_ouoq0_99",Ie="_emptyText_ouoq0_113",u={myReviews:ye,header:Ne,loading:be,reviewsList:ge,emptyState:Ce,emptyContent:Se,emptyTitle:we,emptyText:Ie},Re=w(()=>{const{myReviews:s,loading:c,fetchMyReviews:p}=T;return m.useEffect(()=>{p()},[p]),c&&s.length===0?e.jsx("div",{className:u.loading,children:e.jsx(O,{})}):e.jsxs("div",{className:u.myReviews,children:[e.jsxs("div",{className:u.header,children:[e.jsx("h2",{children:"Мои отзывы"}),e.jsx("p",{children:"Отзыв можно оставить на странице заказа, после его успешного завершения"})]}),s.length>0?e.jsx(d.div,{initial:{opacity:0},animate:{opacity:1},className:u.reviewsList,children:s.map((t,r)=>e.jsx(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:r*.1},children:e.jsx(je,{review:t})},t.id))}):e.jsx(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:u.emptyState,children:e.jsxs("div",{className:u.emptyContent,children:[e.jsx("h3",{className:u.emptyTitle,children:"Отзывов пока нет"}),e.jsx("p",{className:u.emptyText,children:"Здесь будут отображаться все оставленные вами отзывы об аренде аккаунтов"})]})})]})}),Te="_userProfile_1i1mf_1",Le="_container_1i1mf_11",Ue="_header_1i1mf_23",De="_title_1i1mf_31",$e="_content_1i1mf_47",Oe="_sidebar_1i1mf_59",Ae="_profileCard_1i1mf_71",Ee="_avatar_1i1mf_87",Be="_userInfo_1i1mf_115",ke="_username_1i1mf_127",He="_defaultBadge_1i1mf_149",Me="_email_1i1mf_167",Pe="_joinDate_1i1mf_179",qe="_nav_1i1mf_193",Ve="_navItem_1i1mf_207",ze="_active_1i1mf_249",Fe="_actions_1i1mf_259",Xe="_mainContent_1i1mf_271",Ge="_tabContent_1i1mf_287",Je="_stats_1i1mf_301",Ke="_stat_1i1mf_301",Qe="_statValue_1i1mf_329",We="_statLabel_1i1mf_345",Ye="_balanceSection_1i1mf_357",Ze="_balanceHeader_1i1mf_397",ea="_balanceTitle_1i1mf_411",aa="_balanceAmount_1i1mf_425",ta="_balanceDescription_1i1mf_439",sa="_topUpButton_1i1mf_451",na="_breadcrumbs_1i1mf_547",a={userProfile:Te,container:Le,header:Ue,title:De,content:$e,sidebar:Oe,profileCard:Ae,avatar:Ee,userInfo:Be,username:ke,defaultBadge:He,email:Me,joinDate:Pe,nav:qe,navItem:Ve,active:ze,actions:Fe,mainContent:Xe,tabContent:Ge,stats:Je,stat:Ke,statValue:Qe,statLabel:We,balanceSection:Ye,balanceHeader:Ze,balanceTitle:ea,balanceAmount:aa,balanceDescription:ta,topUpButton:sa,breadcrumbs:na},va=w(()=>{const s=A(),[c,p]=m.useState({}),[t,r]=m.useState("profile"),[f,i]=m.useState(!1),{fetchMyReviews:_}=T,{fetchMyOrders:l}=P,[x,N]=m.useState({totalOrders:0,activeOrders:0,totalReviews:0});m.useEffect(()=>{const j=async()=>{const h=await l(),C=await h.filter(U=>["pending","paid","verified","active"].includes(U.status)),L=await _();N({totalOrders:h.length,activeOrders:C.length,totalReviews:L.length})};(async()=>{p(await R.getOneUser())})(),j(),window.scrollTo(0,0)},[_,l]);const b=()=>{window.confirm("Вы уверены, что хотите выйти?")&&logout()},g=j=>new Date(j).toLocaleDateString("ru-RU",{day:"numeric",month:"long",year:"numeric"});return e.jsxs(d.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:a.userProfile,children:[e.jsxs("div",{className:a.container,children:[e.jsxs("nav",{className:a.breadcrumbs,children:[e.jsx("a",{href:S.HOME,children:"Главная"}),e.jsx("span",{children:"/"}),e.jsx("span",{children:"Профиль"})]}),e.jsx(d.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},className:a.header,children:e.jsx("h1",{className:a.title,children:"Профиль"})}),e.jsxs("div",{className:a.content,children:[e.jsxs(d.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:a.sidebar,children:[e.jsxs("div",{className:a.profileCard,children:[e.jsx("div",{className:a.avatar,children:c?.userName?.charAt(0).toUpperCase()||"U"}),e.jsxs("div",{className:a.userInfo,children:[e.jsxs("h3",{className:a.username,children:[c?.userName||"Пользователь",c?.userName==="user"&&e.jsx("span",{className:a.defaultBadge,children:"можно сменить"})]}),e.jsx("p",{className:a.email,children:c?.email}),e.jsxs("p",{className:a.joinDate,children:["Участник с ",g(c?.createdAt||new Date)]})]})]}),e.jsxs("nav",{className:a.nav,children:[e.jsx("button",{className:`${a.navItem} ${t==="profile"?a.active:""}`,onClick:()=>r("profile"),children:"Профиль"}),e.jsx("button",{className:`${a.navItem} ${t==="transactions"?a.active:""}`,onClick:()=>r("transactions"),children:"Транзакции"}),e.jsx("button",{className:`${a.navItem} ${t==="reviews"?a.active:""}`,onClick:()=>r("reviews"),children:"Мои отзывы"}),e.jsx("button",{className:a.navItem,onClick:()=>s(S.ORDERS),children:"Мои заказы"})]}),e.jsxs("div",{className:a.actions,children:[e.jsx(y,{variant:"secondary",size:"medium",onClick:()=>i(!0),children:"Редактировать профиль"}),e.jsx(y,{variant:"primary",size:"medium",onClick:b,children:"Выйти"})]})]}),e.jsxs(d.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:a.mainContent,children:[t==="profile"&&e.jsxs("div",{className:a.tabContent,children:[e.jsx("h2",{children:"Общая информация"}),e.jsxs(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:a.balanceSection,children:[e.jsxs("div",{className:a.balanceHeader,children:[e.jsx("h3",{className:a.balanceTitle,children:"Баланс"}),e.jsxs("div",{className:a.balanceAmount,children:[c?.balance||0," ₽"]})]}),e.jsx("p",{className:a.balanceDescription,children:"Доступные средства для аренды аккаунтов"}),e.jsx(y,{variant:"primary",size:"medium",onClick:()=>s(S.BALANCE),className:a.topUpButton,children:"Пополнить баланс"})]}),e.jsxs("div",{className:a.stats,children:[e.jsxs("div",{className:a.stat,children:[e.jsx("span",{className:a.statValue,children:x.totalOrders}),e.jsx("span",{className:a.statLabel,children:"Всего заказов"})]}),e.jsxs("div",{className:a.stat,children:[e.jsx("span",{className:a.statValue,children:x.activeOrders}),e.jsx("span",{className:a.statLabel,children:"Активные заказы"})]}),e.jsxs("div",{className:a.stat,children:[e.jsx("span",{className:a.statValue,children:x.totalReviews}),e.jsx("span",{className:a.statLabel,children:"Отзывов"})]})]})]}),t==="transactions"&&e.jsx("div",{className:a.tabContent,children:e.jsx(B,{})}),t==="reviews"&&e.jsx("div",{className:a.tabContent,children:e.jsx(Re,{})})]})]})]}),e.jsx(E,{isOpen:f,onClose:()=>i(!1),title:"Редактирование профиля",children:e.jsx(ae,{onClose:()=>i(!1)})})]})});export{va as default};
