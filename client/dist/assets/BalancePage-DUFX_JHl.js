import{o as L,h as C,r as o,j as s,m,R as w,L as I,A as q}from"./index-C-KVzDfL.js";import{B as x}from"./Button-DNnCRmfV.js";import{M as H}from"./Modal-2Jv52JHA.js";import{F as P}from"./FileUpload-C6fJnWni.js";import{T as R}from"./TransactionCard-DKiaLMeN.js";import{P as E}from"./plus-Co95Razd.js";import"./circle-x-CsmGMM7e.js";import"./clock-ClSTzOvM.js";const F="_balancePage_1sb1w_1",U="_container_1sb1w_11",B="_loading_1sb1w_23",O="_header_1sb1w_37",z="_title_1sb1w_47",$="_subtitle_1sb1w_61",V="_balanceCard_1sb1w_73",G="_balanceInfo_1sb1w_89",J="_balanceAmount_1sb1w_103",K="_amount_1sb1w_115",Q="_label_1sb1w_129",W="_balanceActions_1sb1w_141",X="_quickDeposit_1sb1w_151",Y="_sectionTitle_1sb1w_167",Z="_quickAmounts_1sb1w_181",ss="_quickAmount_1sb1w_181",es="_recentTransactions_1sb1w_229",as="_sectionHeader_1sb1w_243",ns="_transactionsList_1sb1w_257",ts="_emptyTransactions_1sb1w_265",cs="_depositModal_1sb1w_321",is="_amountSection_1sb1w_333",os="_amountLabel_1sb1w_345",ls="_amountInput_1sb1w_357",rs="_input_1sb1w_369",ds="_currency_1sb1w_403",ms="_amountHint_1sb1w_419",hs="_methodsSection_1sb1w_433",_s="_methodsLabel_1sb1w_445",ps="_paymentMethods_1sb1w_457",us="_method_1sb1w_433",bs="_selected_1sb1w_501",xs="_radio_1sb1w_511",js="_methodInfo_1sb1w_519",ys="_methodName_1sb1w_533",Ns="_methodDescription_1sb1w_545",ws="_depositSummary_1sb1w_567",fs="_summaryRow_1sb1w_581",vs="_finalAmount_1sb1w_607",As="_modalActions_1sb1w_619",ks="_error_1sb1w_635",gs="_checkUpload_1sb1w_655",Ss="_uploadHint_1sb1w_667",Ts="_methodType_1sb1w_679",Ms="_breadcrumbs_1sb1w_767",e={balancePage:F,container:U,loading:B,header:O,title:z,subtitle:$,balanceCard:V,balanceInfo:G,balanceAmount:J,amount:K,label:Q,balanceActions:W,quickDeposit:X,sectionTitle:Y,quickAmounts:Z,quickAmount:ss,recentTransactions:es,sectionHeader:as,transactionsList:ns,emptyTransactions:ts,depositModal:cs,amountSection:is,amountLabel:os,amountInput:ls,input:rs,currency:ds,amountHint:ms,methodsSection:hs,methodsLabel:_s,paymentMethods:ps,method:us,selected:bs,radio:xs,methodInfo:js,methodName:ys,methodDescription:Ns,depositSummary:ws,summaryRow:fs,finalAmount:vs,modalActions:As,error:ks,checkUpload:gs,uploadHint:Ss,methodType:Ts,breadcrumbs:Ms},Es=L(()=>{const{balance:f,loading:v,fetchBalance:p,createDeposit:A,payMethods:l,fetchPayMethods:j,transactions:y,fetchTransactions:u}=C,[k,r]=o.useState(!1),[t,d]=o.useState(""),[c,h]=o.useState(""),[b,_]=o.useState(null),[N,n]=o.useState("");o.useEffect(()=>{p(),j(),u()},[p,j,u]);const g=async()=>{if(n(""),!t||isNaN(t)||t<100){n("Минимальная сумма пополнения - 100 ₽");return}if(!c){n("Выберите способ оплаты");return}const a=l.find(i=>i.id===c);if(a&&a.type!=="card"&&!b){n("Необходимо загрузить чек об оплате");return}try{const i={amount:parseInt(t),method:l?.find(D=>D.id==c).type};await A(i,b),r(!1),d(""),h(""),_(null),p(),u()}catch(i){console.error("Deposit error:",i),n(i.response?.data?.message||"Ошибка при создании заявки на пополнение")}},S=a=>{_(a),n("")},T=[100,500,1e3,2e3,5e3],M=t&&parseInt(t)>=100&&c&&(l.find(a=>a.id===c)?.type==="card"?!0:b);return s.jsxs(m.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:e.balancePage,children:[s.jsxs("div",{className:e.container,children:[s.jsxs("nav",{className:e.breadcrumbs,children:[s.jsx("a",{href:w.HOME,children:"Главная"}),s.jsx("span",{children:"/"}),s.jsx("a",{href:w.PROFILE,children:"Профиль"}),s.jsx("span",{children:"/"}),s.jsx("span",{children:"Пополнение баланса"})]}),s.jsxs("div",{className:e.header,children:[s.jsx("h1",{className:e.title,children:"Баланс"}),s.jsx("p",{className:e.subtitle,children:"Управление вашими финансами"})]}),v?s.jsx("div",{className:e.loading,children:s.jsx(I,{})}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:e.balanceCard,children:s.jsxs("div",{className:e.balanceInfo,children:[s.jsxs("div",{className:e.balanceAmount,children:[s.jsxs("span",{className:e.amount,children:[f," ₽"]}),s.jsx("span",{className:e.label,children:"Текущий баланс"})]}),s.jsx("div",{className:e.balanceActions,children:s.jsxs(x,{variant:"primary",size:"large",onClick:()=>r(!0),children:[s.jsx(E,{size:20}),"Пополнить"]})})]})}),s.jsxs("div",{className:e.quickDeposit,children:[s.jsx("h3",{className:e.sectionTitle,children:"Быстрое пополнение"}),s.jsx("div",{className:e.quickAmounts,children:T.map(a=>s.jsxs("button",{className:e.quickAmount,onClick:()=>{d(a.toString()),r(!0)},children:[a," ₽"]},a))})]}),s.jsxs("div",{className:e.recentTransactions,children:[s.jsx("div",{className:e.sectionHeader,children:s.jsx("h3",{className:e.sectionTitle,children:"Последние операции"})}),y.length>0?s.jsx(m.div,{initial:{opacity:0},animate:{opacity:1},className:e.transactionsList,children:y.filter(a=>a.type==="deposit").map((a,i)=>s.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:i*.1},children:s.jsx(R,{transaction:a})},a.id))}):s.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:e.emptyState,children:s.jsx("div",{className:e.transactionsList,children:s.jsxs("div",{className:e.emptyTransactions,children:[s.jsx("h4",{children:"Операций пока нет"}),s.jsx("p",{children:"Здесь будут отображаться ваши финансовые операции"})]})})})]})]})]}),s.jsx(H,{isOpen:k,onClose:()=>{r(!1),d(""),h(""),_(null),n("")},title:"Пополнение баланса",size:"medium",children:s.jsxs("div",{className:e.depositModal,children:[N&&s.jsx("div",{className:e.error,children:N}),s.jsxs("div",{className:e.amountSection,children:[s.jsx("label",{className:e.amountLabel,children:"Сумма пополнения"}),s.jsxs("div",{className:e.amountInput,children:[s.jsx("input",{type:"number",value:t,onChange:a=>{d(a.target.value),n("")},placeholder:"Введите сумму",min:"100",className:e.input}),s.jsx("span",{className:e.currency,children:"₽"})]}),s.jsx("p",{className:e.amountHint,children:"Минимальная сумма: 100 ₽"})]}),s.jsxs("div",{className:e.methodsSection,children:[s.jsx("label",{className:e.methodsLabel,children:"Способ оплаты"}),s.jsx("div",{className:e.paymentMethods,children:l.map(a=>s.jsxs("label",{className:`${e.method} ${c===a.id?e.selected:""}`,children:[s.jsx("input",{type:"radio",name:"paymentMethod",value:a.id,checked:c===a.id,onChange:()=>{h(a.id),n("")},className:e.radio}),s.jsxs("div",{className:e.methodInfo,children:[s.jsx("span",{className:e.methodName,children:a.name}),s.jsx("span",{className:e.methodDescription,children:a.details})]}),s.jsx("span",{className:e.methodType,children:a.type==="bank_transfer"?"Банковский перевод":"Криптовалюта"})]},a.id))})]}),s.jsx(q,{children:c&&l.find(a=>a.id===c)?.type!=="card"&&s.jsxs(m.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:e.checkUpload,children:[s.jsx(P,{label:"Чек об оплате *",accept:"image/*,.pdf",onFileChange:S,required:!0}),s.jsx("p",{className:e.uploadHint,children:"Загрузите скриншот или фото чека об оплате"})]})}),s.jsxs("div",{className:e.depositSummary,children:[s.jsxs("div",{className:e.summaryRow,children:[s.jsx("span",{children:"Сумма:"}),s.jsxs("span",{children:[t||0," ₽"]})]}),s.jsxs("div",{className:e.summaryRow,children:[s.jsx("span",{children:"Комиссия:"}),s.jsx("span",{children:"0 ₽"})]}),s.jsxs("div",{className:e.summaryRow,children:[s.jsx("span",{children:"К зачислению:"}),s.jsxs("span",{className:e.finalAmount,children:[t||0," ₽"]})]})]}),s.jsxs("div",{className:e.modalActions,children:[s.jsx(x,{variant:"secondary",onClick:()=>{r(!1),d(""),h(""),_(null),n("")},children:"Отмена"}),s.jsx(x,{variant:"primary",onClick:g,disabled:!M,children:"Создать заявку"})]})]})})]})});export{Es as default};
